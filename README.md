# ОТЧЕТ ПО ЛАБОРАТОРНОЙ РАБОТЕ
## Приложение «Geo & Sensors App»

---

## 1. ЦЕЛЬ РАБОТЫ

Целью данной работы является создание мобильного приложения на платформе Flutter, которое демонстрирует работу с геолокацией и датчиками мобильного устройства. Приложение должно:

- Определять текущие координаты пользователя (широту и долготу)
- Показывать адрес по полученным координатам через геокодинг
- Отображать в реальном времени данные акселерометра (ускорение по осям X, Y, Z)
- Отображать в реальном времени данные гироскопа (угловая скорость по осям X, Y, Z)
- Показывать направление компаса (азимут)

Приложение разработано для платформ Android и iOS и использует нативные возможности устройств для получения данных о местоположении и работе сенсоров.

---

## 2. ИСПОЛЬЗУЕМЫЕ ПАКЕТЫ

Для реализации функционала приложения были использованы следующие пакеты из репозитория pub.dev:

### 2.1. Геолокация
- **geolocator: ^12.0.0** — пакет для определения местоположения устройства. Предоставляет API для получения координат, проверки разрешений и статуса служб геолокации.

### 2.2. Геокодинг
- **geocoding: ^3.0.0** — пакет для преобразования координат в адреса (прямой геокодинг) и адресов в координаты (обратный геокодинг). Используется для получения адреса по координатам.

### 2.3. Датчики движения
- **sensors_plus: ^7.0.0** — пакет для работы с акселерометром и гироскопом устройства. Предоставляет потоки данных (streams) для получения значений ускорения и угловой скорости в реальном времени.

### 2.4. Компас
- **flutter_compass: ^0.7.0** — пакет для получения данных компаса устройства. Позволяет определить направление на север и азимут.

### 2.5. Разрешения
- **permission_handler: ^11.3.0** — пакет для управления разрешениями приложения. Используется для запроса разрешений на доступ к геолокации.

### 2.6. Базовые зависимости
- **flutter** — SDK Flutter для разработки кроссплатформенных приложений
- **material** — библиотека Material Design для создания пользовательского интерфейса

---

## 3. ОСНОВНЫЕ ФРАГМЕНТЫ КОДА

### 3.1. Структура приложения

Приложение состоит из одного основного экрана `GeoSensorsPage`, который является StatefulWidget и управляет состоянием всех данных.

```dart
class GeoSensorsPage extends StatefulWidget {
  const GeoSensorsPage({super.key});
  @override
  State<GeoSensorsPage> createState() => _GeoSensorsPageState();
}
```

### 3.2. Переменные состояния

В классе `_GeoSensorsPageState` определены переменные для хранения данных:

```dart
Position? _position;                    // Текущая позиция
String _address = '–';                  // Адрес по координатам
double? _compass;                       // Направление компаса
List<double>? _accelerometerValues;     // Значения акселерометра [X, Y, Z]
List<double>? _gyroscopeValues;         // Значения гироскопа [X, Y, Z]
```

### 3.3. Получение местоположения

Метод `_getLocation()` реализует получение координат и адреса:

```dart
Future<void> _getLocation() async {
  // Проверка доступности службы геолокации
  bool serviceEnabled = await Geolocator.isLocationServiceEnabled();
  if (!serviceEnabled) return;

  // Запрос разрешения
  LocationPermission permission = await Geolocator.requestPermission();
  if (permission == LocationPermission.denied) return;

  // Получение текущей позиции
  final pos = await Geolocator.getCurrentPosition(
    desiredAccuracy: LocationAccuracy.high,
  );

  // Преобразование координат в адрес
  List<Placemark> placemarks =
      await placemarkFromCoordinates(pos.latitude, pos.longitude);

  setState(() {
    _position = pos;
    _address = '${placemarks.first.locality}, ${placemarks.first.street ?? ''}';
  });
}
```

### 3.4. Инициализация датчиков

В методе `initState()` настраиваются подписки на потоки данных датчиков:

```dart
@override
void initState() {
  super.initState();

  // Подписка на события акселерометра
  accelerometerEvents.listen((event) {
    setState(() => _accelerometerValues = [event.x, event.y, event.z]);
  });

  // Подписка на события гироскопа
  gyroscopeEvents.listen((event) {
    setState(() => _gyroscopeValues = [event.x, event.y, event.z]);
  });

  // Подписка на события компаса
  if (FlutterCompass.events != null) {
    FlutterCompass.events!.listen((event) {
      setState(() => _compass = event.heading);
    });
  }
}
```

### 3.5. Пользовательский интерфейс

Интерфейс приложения реализован с использованием Material Design:

```dart
@override
Widget build(BuildContext context) {
  return Scaffold(
    appBar: AppBar(title: const Text('Geo & Sensors Demo')),
    body: Padding(
      padding: const EdgeInsets.all(16),
      child: ListView(
        children: [
          // Кнопка для получения местоположения
          ElevatedButton(
            onPressed: _getLocation,
            child: const Text('Определить местоположение'),
          ),
          // Отображение координат и адреса
          Text('Координаты: ${_position?.latitude}, ${_position?.longitude}'),
          Text('Адрес: $_address'),
          // Отображение данных компаса
          Text('Компас: ${_compass?.toStringAsFixed(2) ?? '–'}°'),
          // Отображение данных акселерометра и гироскопа
          Text('Акселерометр: ${_accelerometerValues?.map((e) => e.toStringAsFixed(2)).join(', ') ?? '–'}'),
          Text('Гироскоп: ${_gyroscopeValues?.map((e) => e.toStringAsFixed(2)).join(', ') ?? '–'}'),
        ],
      ),
    ),
  );
}
```

### 3.6. Настройка разрешений

Для Android в файле `AndroidManifest.xml` добавлены разрешения:

```xml
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
```

Для iOS в файле `Info.plist` добавлено описание:

```xml
<key>NSLocationWhenInUseUsageDescription</key>
<string>Приложению необходимо ваше местоположение</string>
```

---

## 4. РЕЗУЛЬТАТЫ И ВЫВОДЫ

### 4.1. Результаты работы приложения

Приложение успешно реализует все требуемые функции:

1. **Определение координат**: При нажатии на кнопку "Определить местоположение" приложение запрашивает разрешение на доступ к геолокации и получает текущие координаты устройства (широту и долготу) с высокой точностью.

2. **Геокодинг**: По полученным координатам приложение определяет адрес местоположения, включая город и улицу.

3. **Акселерометр**: Приложение в реальном времени отображает значения ускорения по трем осям (X, Y, Z) в единицах м/с². Значения обновляются при движении или наклоне устройства.

4. **Гироскоп**: Приложение в реальном времени отображает значения угловой скорости по трем осям (X, Y, Z) в единицах рад/с. Данные обновляются при вращении устройства.

5. **Компас**: Приложение отображает направление на север в градусах (0-360°). Значение обновляется при изменении ориентации устройства.

### 4.2. Скриншоты работы приложения

**Скриншот 1: Отображение координат и адреса**
- На экране отображаются текущие координаты (например: 55.755814, 37.617635)
- Ниже выводится адрес, соответствующий этим координатам (например: "Москва, Красная площадь")

**Скриншот 2: Реакция сенсоров (акселерометр/гироскоп)**
- В разделе "Акселерометр" отображаются три значения, например: "0.12, -9.81, 0.05"
- В разделе "Гироскоп" отображаются три значения, например: "0.01, -0.02, 0.00"
- При движении устройства значения изменяются в реальном времени

**Скриншот 3: Компас**
- В разделе "Компас" отображается значение в градусах, например: "45.23°"
- Значение изменяется при повороте устройства

### 4.3. Выводы

В ходе выполнения работы были достигнуты следующие результаты:

1. **Успешная интеграция геолокации**: Приложение корректно определяет местоположение устройства с использованием GPS и сетевых данных. Реализована обработка разрешений и проверка доступности служб геолокации.

2. **Работа с геокодингом**: Успешно реализовано преобразование координат в адреса с использованием сервиса геокодинга. Приложение получает структурированную информацию о местоположении.

3. **Работа с датчиками движения**: Приложение успешно получает и отображает данные акселерометра и гироскопа в реальном времени. Использованы потоки данных (streams) для эффективной обработки событий.

4. **Работа с компасом**: Реализовано определение направления на север с использованием магнитного компаса устройства. Добавлена проверка доступности датчика.

5. **Пользовательский интерфейс**: Создан интуитивно понятный интерфейс с использованием Material Design, который позволяет пользователю легко взаимодействовать с приложением и видеть все данные в реальном времени.

### 4.4. Технические особенности

- Приложение использует асинхронное программирование для работы с геолокацией и геокодингом
- Реализована обработка ошибок и проверка доступности сервисов
- Использованы потоки данных для эффективной работы с сенсорами
- Приложение адаптировано для работы на платформах Android и iOS

### 4.5. Возможные улучшения

В будущем приложение можно улучшить следующими способами:

1. Добавление визуализации данных сенсоров в виде графиков
2. Сохранение истории местоположений
3. Добавление карты с отображением текущей позиции
4. Улучшение обработки ошибок и отображения сообщений пользователю
5. Добавление настроек точности определения местоположения

---

**Дата выполнения:** _______________  
**Выполнил:** _______________  
**Проверил:** _______________
